<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decodificador ASCII para Lua</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Decodificador ASCII para Lua</h1>
            <p>Converta códigos ASCII em scripts Lua de forma rápida e precisa</p>
        </header>

        <div class="main-content">
            <div class="panel config-panel">
                <h2><i class="fas fa-cog"></i> Configurações</h2>

                <div class="form-group">
                    <label for="ascii-input">Entrada ASCII:</label>
                    <textarea id="ascii-input" class="form-control" placeholder="Ex: 109\98\111\116\95\70\79\86\95\82\97\100\105\117\115"></textarea>
                </div>

                <div class="form-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="strict-mode" checked>
                        Modo Estrito (0-127)
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="auto-scroll" checked>
                        Auto Rolagem
                    </label>
                </div>

                <div class="buttons">
                    <button id="decode-btn" class="btn btn-primary"><i class="fas fa-play"></i> Decodificar</button>
                    <button id="example-btn" class="btn btn-success"><i class="fas fa-lightbulb"></i> Exemplo</button>
                    <button id="clear-btn" class="btn btn-danger"><i class="fas fa-trash"></i> Limpar</button>
                </div>
            </div>

            <div class="panel output-container">
                <h2><i class="fas fa-file-code"></i> Resultado</h2>
                <textarea id="result" readonly></textarea>

                <div class="output-stats">
                    <div>Caracteres: <span id="char-count">0</span></div>
                    <div>Linhas: <span id="line-count">0</span></div>
                </div>

                <div class="buttons">
                    <button id="copy-btn" class="btn btn-success"><i class="fas fa-copy"></i> Copiar</button>
                    <button id="download-btn" class="btn btn-danger"><i class="fas fa-download"></i> Baixar Arquivo</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Decodificador ASCII para Lua &copy; 2025 - Todos os direitos reservados</p>
        </footer>
    </div>

    <div class="notification" id="notification">Operação realizada com sucesso!</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const asciiInput = document.getElementById('ascii-input');
            const decodeBtn = document.getElementById('decode-btn');
            const clearBtn = document.getElementById('clear-btn');
            const exampleBtn = document.getElementById('example-btn');
            const copyBtn = document.getElementById('copy-btn');
            const downloadBtn = document.getElementById('download-btn');
            const resultOutput = document.getElementById('result');
            const charCount = document.getElementById('char-count');
            const lineCount = document.getElementById('line-count');
            const strictMode = document.getElementById('strict-mode');
            const autoScroll = document.getElementById('auto-scroll');

            const exampleCode = "108\\111\\99\\97\\108\\32\\110\\117\\109\\98\\101\\114\\10\\102\\111\\114\\32\\105\\32\\61\\32\\49\\44\\32\\49\\48\\32\\100\\111\\32\\100\\111\\10\\9\\110\\117\\109\\98\\101\\114\\32\\61\\32\\110\\117\\109\\98\\101\\114\\32\\43\\32\\49\\10\\9\\112\\114\\105\\110\\116\\40\\34\\78\\117\\109\\98\\101\\114\\58\\32\\34\\32\\46\\46\\32\\110\\117\\109\\98\\101\\114\\41\\10\\101\\110\\100";

            exampleBtn.addEventListener('click', function() {
                asciiInput.value = exampleCode;
                decodeASCII();
                showNotification("Exemplo carregado com sucesso!");
            });

            decodeBtn.addEventListener('click', decodeASCII);
            clearBtn.addEventListener('click', () => {
                asciiInput.value = '';
                resultOutput.value = '';
                charCount.textContent = '0';
                lineCount.textContent = '0';
                showNotification("Campos limpos com sucesso!");
            });

            copyBtn.addEventListener('click', () => {
                if(resultOutput.value.trim() === '') {
                    showNotification("Nada para copiar!", true);
                    return;
                }
                navigator.clipboard.writeText(resultOutput.value).then(() => showNotification("Texto copiado!"));
            });

            downloadBtn.addEventListener('click', () => {
                if(resultOutput.value.trim() === '') {
                    showNotification("Nada para baixar!", true);
                    return;
                }
                const blob = new Blob([resultOutput.value], { type: 'text/plain' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'script.lua';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            function decodeASCII() {
                const input = asciiInput.value.trim();
                if (!input) { showNotification("Por favor, insira algum código ASCII.", true); return; }

                let codes = input.includes('\\') ? input.split('\\').filter(c => c !== '') : input.split(/[\s,]+/).filter(c => c !== '');
                let result = '';
                let errors = [];

                for(let code of codes) {
                    if(!/^\d+$/.test(code)) { errors.push(`"${code}" não é válido`); continue; }
                    const num = parseInt(code, 10);
                    if(strictMode.checked && (num < 0 || num > 127)) { errors.push(`Código ${num} fora do intervalo ASCII`); continue; }
                    result += String.fromCharCode(num);
                }

                resultOutput.value = result;
                charCount.textContent = result.length;
                lineCount.textContent = result.split('\n').length;

                if(autoScroll.checked) resultOutput.scrollTop = resultOutput.scrollHeight;

                showNotification(errors.length > 0 ? `Decodificado com ${errors.length} erro(s)` : "Decodificação concluída!");
            }

            function showNotification(message, isError = false) {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = 'notification' + (isError ? ' error' : '');
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 3000);
            }
        });
    </script>
</body>
</html>
